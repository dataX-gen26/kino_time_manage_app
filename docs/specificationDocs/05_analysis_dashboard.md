# 機能仕様書: 分析ダッシュボード

- **ID**: 05
- **機能名**: ダッシュボードでのデータ可視化
- **関連要件**: 分析・レポート機能

## 1. 機能概要

記録された実績データを様々なグラフを用いて可視化し、ユーザーが自身の時間の使い方を多角的に分析できるようにする。

## 2. 仕様詳細

### 2.1. ダッシュボードUI

- メイン画面とは別の「ダッシュボード」ページとして提供する。
- ページ上部に、分析対象期間を切り替えるためのUIを配置する。
    - **期間選択**: 「日次」「週次」「月次」のタブまたはボタン。
    - **日付選択**: 選択した期間に応じて、対象となる日付、週、月を選択するナビゲーション（例: `2025年6月`、`2025年第26週`）。
- 選択された期間と対象に基づき、以下のグラフを動的に描画する。

### 2.2. 可視化グラフ一覧

#### ① カテゴリ別時間配分 (円グラフ/ドーナツグラフ)

- **目的**: 指定期間内の総活動時間における、各カテゴリの占める割合を可視化する。
- **表示**: 
    - グラフの中央に総活動時間を表示。
    - 各カテゴリが色分けされたセグメントで表示され、マウスオーバーでカテゴリ名、時間、割合（%）をツールチップで表示。
- **対象期間**: 日次, 週次, 月次

#### ② 日別活動時間の推移 (積み上げ棒グラフ)

- **目的**: 期間内の日々の活動時間の総量と、そのカテゴリ内訳の変動を追跡する。
- **表示**: 
    - 横軸に日付（または曜日）、縦軸に時間。
    - 各日の棒グラフの高さがその日の総活動時間を示す。
    - 棒グラフはカテゴリごとに色分けされた積み上げ形式で表示される。
- **対象期間**: 週次, 月次

#### ③ 生産性指標のトレンド (折れ線グラフ)

- **目的**: 生産性に関連する指標の推移を時系列で確認し、改善の進捗を定量的に把握する。
- **表示**: 
    - 横軸に日付、縦軸に時間。
    - 以下の指標をそれぞれ別の色の折れ線で表示する。
        - **生産時間**: 「仕事」「学習」など、ユーザーが「生産的」と定義したカテゴリの合計時間。
        - **非生産時間**: 「休憩」「浪費」など、ユーザーが「非生産的」と定義したカテゴリの合計時間。
        - **問題発生時間**: 「問題あり」フラグが立った実績の合計時間。
- **対象期間**: 週次, 月次
- **補足**: どのカテゴリを「生産」「非生産」と見なすかは、ユーザーが設定画面でカスタマイズできる。

#### ④ 予定 vs 実績の比較 (棒グラフ)

- **目的**: 計画（Googleカレンダーの予定）と実行（生産的なカテゴリの実績）のギャップを分析する。
- **表示**: 
    - 横軸に日付。
    - 各日に対して、「計画時間（Googleカレンダーの総時間）」と「実行時間（生産カテゴリの総時間）」の2本の棒グラフを並べて表示。
- **対象期間**: 週次, 月次

## 3. APIエンドポイント

- `GET /api/v1/dashboard/summary?period=daily&date=YYYY-MM-DD`: カテゴリ別時間配分（日次）のデータを取得。
- `GET /api/v1/dashboard/summary?period=weekly&date=YYYY-MM-DD`: 週次の各グラフ用データをまとめて取得。
- `GET /api/v1/dashboard/summary?period=monthly&date=YYYY-MM`: 月次の各グラフ用データをまとめて取得。

## 4. その他

- グラフ描画ライブラリには`Chart.js`や`ECharts`などの利用を検討する。
- データ集計はバックエンドで効率的に行い、APIのレスポンスを最適化する。
